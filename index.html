<!DOCTYPE html><html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gra Bartosza</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f9f9f9;
      padding: 20px;
      max-width: 600px;
      margin: auto;
    }
    h1, h2 {
      text-align: center;
    }
    .hidden {
      display: none;
    }
    .button {
      display: block;
      margin: 10px 0;
      padding: 10px;
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
      width: 100%;
    }
    .button:hover {
      background-color: #45a049;
    }
    .message {
      margin: 15px 0;
      padding: 10px;
      background-color: #e7f3fe;
      border-left: 6px solid #2196F3;
    }
  </style>
</head>
<body>
  <h1>Gra Bartosza</h1>
  <div id="messageBox" class="message hidden"></div>
  <div id="game"></div>  <script>
    const gameData = {
      postacie: [
        "Eryk", "Fabian", "Jakub", "Ola", "Nikola", "Kot", "Oliwia"
      ],
      zakończenia: {},
      wybaczenia: {},
      unlocked: {
        Oliwia: false,
        Bartek: false
      },
      currentPath: [],
    };

    const gameContainer = document.getElementById("game");
    const messageBox = document.getElementById("messageBox");

    function showMessage(text) {
      messageBox.textContent = text;
      messageBox.classList.remove("hidden");
    }

    function clearMessage() {
      messageBox.classList.add("hidden");
    }

    function startGame() {
      clearMessage();
      gameContainer.innerHTML = `<h2>Wybierz postać:</h2>`;

      gameData.postacie.forEach(postac => {
        if (postac === "Oliwia" && !gameData.unlocked.Oliwia) return;
        if (postac === "Bartek" && !gameData.unlocked.Bartek) return;

        const btn = document.createElement("button");
        btn.className = "button";
        btn.textContent = postac;
        btn.onclick = () => startPath(postac);
        gameContainer.appendChild(btn);
      });

      checkUnlocks();
    }

    function checkUnlocks() {
      const zakończone = Object.keys(gameData.zakończenia);

      const postacieZ3Zakończeniami = gameData.postacie.filter(p =>
        gameData.zakończenia[p] && gameData.zakończenia[p].length >= 3
      );

      if (postacieZ3Zakończeniami.length >= 3 && !gameData.unlocked.Oliwia) {
        gameData.unlocked.Oliwia = true;
        showMessage("Odblokowano postać: Oliwia!");
      }

      const wybaczonePostacie = Object.keys(gameData.wybaczenia).filter(p => gameData.wybaczenia[p]);
      if (wybaczonePostacie.length === gameData.postacie.length - 2 && !gameData.unlocked.Bartek) {
        gameData.unlocked.Bartek = true;
        gameData.postacie.push("Bartek");
        showMessage("Wszystkie postacie wybaczyły Bartkowi. Odblokowano postać: Bartek!");
      }
    }

    function startPath(postac) {
      clearMessage();
      gameData.currentPath = [postac];
      showScene(postac, 1);
    }

    function showScene(postac, sceneNumber) {
      gameContainer.innerHTML = `<h2>${postac} — Scena ${sceneNumber}</h2>`;
      for (let i = 1; i <= 3; i++) {
        const btn = document.createElement("button");
        btn.className = "button";
        btn.textContent = `Opcja ${i}`;
        btn.onclick = () => makeChoice(postac, sceneNumber, i);
        gameContainer.appendChild(btn);
      }
    }

    function makeChoice(postac, scene, opcja) {
      gameData.currentPath.push(`Scena ${scene}, Opcja ${opcja}`);

      if (!gameData.zakończenia[postac]) gameData.zakończenia[postac] = [];
      if (!gameData.zakończenia[postac].includes(`Zakończenie ${scene}.${opcja}`)) {
        gameData.zakończenia[postac].push(`Zakończenie ${scene}.${opcja}`);
      }

      if (scene === 3) {
        gameData.wybaczenia[postac] = opcja === 3;
        showEnding(postac, opcja);
      } else {
        showScene(postac, scene + 1);
      }
    }

    function showEnding(postac, opcja) {
      gameContainer.innerHTML = `<h2>Zakończenie postaci ${postac}</h2><p>Wybrałeś opcję ${opcja}. ${opcja === 3 ? "Postać wybaczyła Bartkowi." : "Postać nie wybaczyła."}</p>`;
      const btn = document.createElement("button");
      btn.className = "button";
      btn.textContent = "Powrót do wyboru postaci";
      btn.onclick = startGame;
      gameContainer.appendChild(btn);
      checkUnlocks();
    }

    startGame();
  </script></body>
</html>
